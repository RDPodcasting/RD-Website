
@{
    ViewBag.Title = "Covid19";
    Layout = null;
}
<!doctype html>
<html lang="pt-br">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <link href="~/Content/Covid.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <h1 class="text-center text-monospace">Progresso do <b class="font-weight-bolder text-danger">CORONAVÍRUS</b> no <span class="text-success">Brasil</span></h1>


                @if (ViewBag.CovidData != null)
                {
                    <div class="table-responsive">
                        <table class="table table-dark text-center">
                            <caption data-toggle="tooltip" data-placement="right" data-html="true" title="<em>Atualizado conforme os </em> <u>dados</u> <b>oficiais</b>">
                                Última atualização: @ViewBag.CovidData.Last_Update
                            </caption>
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Casos confirmados</th>
                                    <th scope="col">Infectados em tratamento</th>
                                    <th scope="col">Mortos</th>
                                    <th scope="col">Infectados curados</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">1</th>
                                    <td data-toggle="tooltip" data-placement="right" data-html="true" title="<em>Cada pessoa infectada tem </em> <u>estimativa</u> de infectar <b>de 1 à 3 pessoas</b>, estamos falando em um total de
                                        @{

                                          var resultado = int.Parse(ViewBag.CovidData.Confirmed) * 3;
                                            @resultado.ToString();
                                        } casos, se as pessoas não ficarem em quarentena.">
                                        @ViewBag.CovidData.Confirmed
                                    </td>
                                    <td data-toggle="tooltip" data-placement="left" data-html="true" title="<em>Às pessoas costumam ficar </em> <u>doentes</u> em um periodo de <b>14 à 21 dias</b>, estamos falando de gente se recuperando ainda em
                                        @{

                                            var qtdeDeDias = DateTime.Now.AddDays(21).ToString("dd.MM.yyyy");
                                            @qtdeDeDias.ToString();
                                        }, então por favor, fique em casa de quarentena!">

                                        @ViewBag.CovidData.Active
                                    </td>
                                    <td data-toggle="tooltip" data-placement="right" data-html="true" title="<em>Os casos graves de coronavírus</em> acontecem geralmente em <u>idosos, diabéticos e hipertensos.</u> Pessoas com doenças <b>cardiovasculares e pulmonares</b> também fazem parte do grupo de risco idependente da idade."> @ViewBag.CovidData.Deaths</td>
                                    <td data-toggle="tooltip" data-placement="left" data-html="true" title="<em>O Coronavírus (COVID-19)</em> não é uma gripezinha ou resfriadinho, mas <u>pessoas jovens e pessoas sem o sistema imunológico prejudicado por doenças crônicas</u>, tendem a se recuperar dentro de um período de <b>11 à 14 dias.</b>">@ViewBag.CovidData.Recovered</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                }
                else
                {
                    <h3>Houve algum problema, tente novamente em alguns minutos.</h3>
                }
            </div>
            <div class="w-100"></div>
            <div class="col">
                <div id="donutchart_day" style="border: 1px solid #ccc"></div>
            </div>
            <div class="col">
                <div id="myPieChart" style="border: 1px solid #ccc"></div>
            </div>
            <div class="w-100"></div>
            <div class="col">
                <div id="GraficoDeDias" style="border: 1px solid #ccc"></div>
            </div>
            <div class="col">
                <div id="GraficoDeMeses" style="border: 1px solid #ccc"></div>
            </div>
        </div>
        <div class="w-100"></div>
        <div class="col">
            <footer class="blockquote-footer">
                <blockquote class="blockquote text-center">
                    Os dados utilizados nessa <strong>análise</strong> são mantidos e operados, pelo <mark>Centro de Ciência e Engenharia da Universidade Johns Hopkins (JHU CSSE)</mark>. Além disso, com o apoio da <u>ESRI Living Atlas Team</u> e do <u>Laboratório de Física Aplicada da <a data-toggle="tooltip" data-placement="top" title="Clique aqui para conhecer o estudo" target="_blank" href="https://systems.jhu.edu/research/public-health/ncov/">Johns Hopkins University</a> (JHU APL)</u>.
                </blockquote>
                <p class="text-center"><strong>Copyright © @DateTime.Now.Year - <a data-toggle="tooltip" data-placement="top" title="Clique aqui para conhecer o projeto" href="@Url.Action("Index","Home")">Remédios Demais Podcast</a>.</strong> All rights reserved.</p>
            </footer>
        </div>
    </div>
    <div class="progress" id="PreLoaderBar">
        <div class="indeterminate"></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>

    <script src="https://www.gstatic.com/charts/loader.js"></script>

    <script async src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

</body>
</html>

<script>
    document.onreadystatechange = function () {
        if (document.readyState == "loading")
        {
            console.log(document.readyState + ": agora estamos carregando o html5!");

        }
        if (document.readyState == "interactive")
        {
            console.log(document.readyState+": agora estamos carregando css3, js e boostrap!");

        } else if (document.readyState === "complete") {
            console.log(document.readyState + ": agora a página está quase lá, falta os gráficos!");
            document.getElementById("PreLoaderBar").style.display = "none";
        }
    }
</script>
<script async>
        jQuery(document).ready(function () {
            google.charts.load('current', { packages: ['corechart'] });
            google.charts.setOnLoadCallback(drawChart);
            google.charts.setOnLoadCallback(drawChartDonout);
            console.log();
            console.log("Iniciando carregamento dos gráficos!");
            function drawChart() {
                // Define the chart to be drawn.
                var data = new google.visualization.DataTable();
                data.addColumn('string', 'Element');
                data.addColumn('number', 'Percentage');
                data.addRows([
                    ['Aumento de Infectados em tratamento',@ViewBag.CovidMesAtual.InfectadosEmTratamento - @ViewBag.CovidMesAnterior.InfectadosEmTratamento],
                    ['Aumento de Mortos', @ViewBag.CovidMesAtual.Mortos - @ViewBag.CovidMesAnterior.Mortos],
                    ['Aumento de Infectados curados', @ViewBag.CovidMesAtual.InfectadosCurados - @ViewBag.CovidMesAnterior.InfectadosCurados]
                ]);

                var options = {
                    'legend': 'left',
                    'title': 'Aumento de casos de COVID-19 em relação ao mês anterior no Brasil',
                    'is3D': true,
                    'width': 400,
                    'height': 200
                }

                // Instantiate and draw the chart.
                var chart = new google.visualization.PieChart(document.getElementById('myPieChart'));
                chart.draw(data, options);
                console.log("gráficos 1: Carregado!");
            }

            function drawChartDonout() {
                var data = google.visualization.arrayToDataTable([
                    ['Legendas', 'Casos'],
                    ['Infectados em tratamento', @ViewBag.CovidMesAtual.InfectadosEmTratamento],
                    ['Mortos', @ViewBag.CovidMesAtual.Mortos],
                    ['Infectados curados', @ViewBag.CovidMesAtual.InfectadosCurados]
                ]);

                var options = {
                    title: 'Casos somente nesse mês',
                    pieHole: 0.2,
                    width: 400,
                    height: 200,
                    legend: { position: 'left' }
                };

                var chart = new google.visualization.PieChart(document.getElementById('donutchart_day'));
                chart.draw(data, options);
                console.log("gráficos 2: Carregado!");
            }

        });
</script>

<script async>
    
    google.charts.load('current', { packages: ['line'] });
    
        jQuery.get("/Home/GetDataGraficoDias/",
            function (data,status)
            {
                if (status == "success") {
                    console.log("iniciando gráficos de linha!");
                        // Draw.
                    drawGraph(data, 'linechart_material');
                }
            })


    // Callback that creates and populates a data table,
    // instantiates the pie chart, passes in the data and
    // draws it.
    function drawGraph(ListaCovidData) {

        // Set chart options
        var options = {
            chart: {
                title: 'Progresso por dia, sobre os casos de COVID-19',
                subtitle: 'Somente no Brasil',
                curveType: 'function'
            },
            width: 600,
            height: 400,
            series: {
                // Gives each series an axis name that matches the Y-axis below.
                0: { axis: 'Temps' },
                1: { axis: 'Temps' },
                2: { axis: 'Temps' }
            },
            axes: {
                // Adds labels to each axis; they don't have to match the axis names.
                y: {
                    Temps: { label: 'Quantidade (Infectados)' },
                },
                x: {
                    0: { side: 'bottom' }
                }
            }
        };
        var elementId = 'GraficoDeDias';

        // Initialization.
        var data = new google.visualization.DataTable();

        // Setting.
        data.addColumn('number', 'dias');
        data.addColumn('number', 'Casos confirmados');
        //data.addColumn('number', 'Infectados em tratamento');
        data.addColumn('number', 'Mortos');
        data.addColumn('number', 'Infectados curados');

        // Processing.
        for (var i = 0; i < ListaCovidData.ListaDias.length; i++) {
            // Setting.
            data.addRow([ListaCovidData.ListaDias[i].Dia,
            ListaCovidData.ListaDias[i].CasosConfirmados,
            // ListaCovidData.ListaDias[i].InfectadosEmTratamento,
            ListaCovidData.ListaDias[i].Mortos,
            ListaCovidData.ListaDias[i].InfectadosCurados]);
        }

        // Setting label.
        var view = new google.visualization.DataView(data);
        view.setColumns([0, 1,
            {
                calc: "stringify",
                sourceColumn: 1,
                type: "string",
                role: "annotation"
            },
            2,
            {
                calc: "stringify",
                sourceColumn: 2,
                type: "string",
                role: "annotation"
            }
        ]);

        var chart = new google.charts.Line(document.getElementById(elementId));

        chart.draw(data, google.charts.Line.convertOptions(options));
        console.log("gráficos 3: Carregado!");

        var elementIdMensal = 'GraficoDeMeses';
        // Set chart options
        var optionsMensal = {
            chart: {
                title: 'Progresso por meses, sobre os casos de COVID-19',
                subtitle: 'Somente no Brasil',
                curveType: 'function'
            },
            width: 600,
            height: 400,
            series: {
                // Gives each series an axis name that matches the Y-axis below.
                0: { axis: 'Temps' },
                1: { axis: 'Temps' },
                2: { axis: 'Temps' }
            },
            axes: {
                // Adds labels to each axis; they don't have to match the axis names.
                y: {
                    Temps: { label: 'Quantidade (Infectados)' },
                },
                x: {
                    0: { side: 'bottom' }
                }
            }
        };

        // Initialization.
        var dataMensal = new google.visualization.DataTable();

        // Setting.
        dataMensal.addColumn('string', 'Meses');
        dataMensal.addColumn('number', 'Casos confirmados');
        //data.addColumn('number', 'Infectados em tratamento');
        dataMensal.addColumn('number', 'Mortos');
        dataMensal.addColumn('number', 'Infectados curados');

        // Processing.
        for (var i = 0; i < ListaCovidData.ListaMes.length; i++) {
            // Setting.
            dataMensal.addRow([ListaCovidData.ListaMes[i].Mes,
            ListaCovidData.ListaMes[i].CasosConfirmados,
            // ListaCovidData.ListaDias[i].InfectadosEmTratamento,
            ListaCovidData.ListaMes[i].Mortos,
            ListaCovidData.ListaMes[i].InfectadosCurados]);
        }

        // Setting label.
        var viewMensal = new google.visualization.DataView(dataMensal);
        viewMensal.setColumns([0, 1,
            {
                calc: "stringify",
                sourceColumn: 1,
                type: "string",
                role: "annotation"
            },
            2,
            {
                calc: "stringify",
                sourceColumn: 2,
                type: "string",
                role: "annotation"
            }
        ]);

        var chartMensal = new google.charts.Line(document.getElementById(elementIdMensal));

        chartMensal.draw(dataMensal, google.charts.Line.convertOptions(optionsMensal));
        console.log("gráficos 4: Carregado!");
        console.log();
        console.log("Finalizando carregamento dos gráficos!");
        console.log();
        console.log("Página totalmente carregada!");
    }
</script>
<script async>
    jQuery(function () {
        jQuery('[data-toggle="tooltip"]').tooltip()
    })
</script>


<script async>
    var time = new Date().getTime();
    jQuery(document.body).bind("mousemove keypress", function (e) {
        time = new Date().getTime();
    });

    function refresh() {
        if (new Date().getTime() - time >= 600000)
            window.location.reload(true);
        else
            setTimeout(refresh, 10000);
    }

    setTimeout(refresh, 10000);
</script>






